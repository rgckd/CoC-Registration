Below is the **final, authoritative Copilot / coding-LLM prompt**, with **everything baked in**, including the **correct join condition**:

> **Participants.AssignedGroup === Groups.GroupName**

This version supersedes all previous prompts.
You can paste this **as-is** into Copilot Chat, Cursor, or any coding LLM.

---

## üìå **FINAL SYSTEM PROMPT ‚Äî Coordinator Group Status Update**

---

### Context

You are extending an existing production system with the following characteristics:

* **Frontend**: Static HTML + Vanilla JavaScript
* **Backend**: Google Apps Script, published as a **single Web App**
* **Storage**: Google Sheets
* **Security**: Google reCAPTCHA v3 + honeypot
* **Hosting**: GitHub Pages / Google Sites
* **Admin workflows** are sheet-driven and explicit

The system already includes:

* A public **registration form**
* A registration backend (`doPost`)
* Admin grouping logic
* A **single Apps Script Web App** that routes requests via an `action` parameter

‚ö†Ô∏è You must **extend the same Web App**.
‚ùå Do NOT create a new deployment.

---

## üéØ New Feature to Implement

### **Coordinator Group Status Update Page**

Create a **new HTML page + backend handlers** that allow **group coordinators** to periodically update:

* Whether their group is active
* How many weeks the group has completed
* Which members are active
* Optional coordinator notes

---

## üß© Frontend Requirements (New HTML Page)

### 1. Language Selection

* First step: select language (same UX pattern as registration page)
* Canonical values only:

  ```
  English, Tamil, Hindi, Kannada, Telugu
  ```

---

### 2. Coordinator Selection

* After language selection:

  * Fetch **groups for that language**
  * Each group has exactly one coordinator
* Dropdown format:

  ```
  <Coordinator Name> (<Group Name>)
  ```
* Each option must internally carry:

  * `GroupID` (opaque, backend reference)
  * `GroupName` (display + member lookup)

---

### 3. Group Status

* Ask:

  > ‚ÄúIs your group currently active?‚Äù
* Control: Yes / No
* Backend update:

  * Update **Groups.Status**
  * Allowed values:

    ```
    Active | Inactive
    ```

---

### 4. Weeks Completed

* Shown only if Status = Active
* Dropdown values:

  ```
  0 ‚Äì 20
  ```
* Backend update:

  * `Groups.WeeksCompleted`

---

### 5. Member Participation (Critical)

* List **all members of the selected group**
* Display:

  ```
  Member Name   [Active / Not Active]
  ```
* Data source: **Participants sheet**
* **Authoritative join condition**:

  ```
  Participants.AssignedGroup === Groups.GroupName
  ```
* Always:

  * Show the current `IsActive` value from the sheet
  * Allow coordinator to update it
* Backend update:

  * Update `Participants.IsActive`
  * Do not overwrite any other participant fields

---

### 6. Coordinator Notes

* Free-text comments
* Backend update:

  * `Groups.Notes`

---

## üîê Security Requirements

* Same **reCAPTCHA v3** flow as registration
* Honeypot field
* Backend must validate:

  * reCAPTCHA score
  * Required fields
  * Coordinator ‚Üî Group consistency
    (coordinator can update **only their group**)

---

## üîÅ Backend Architecture (Apps Script)

### Single Web App Dispatcher

Extend the existing `doPost` handler using an `action` parameter.

Example pattern:

```js
switch (action) {
  case "register":
  case "queryCoordinatorGroups":
  case "getGroupMembers":
  case "updateGroupStatus":
    break;
}
```

---

## üß† Data Model (Authoritative)

### Groups Sheet

Columns include:

* `GroupID` (unique, generated by admin scripts)
* `GroupName`
* `Language`
* `CoordinatorName`
* `Status` (Active / Inactive)
* `WeeksCompleted`
* `Notes`

‚ö†Ô∏è There is **no `IsActive` column** in Groups.

---

### Participants Sheet

Columns include:

* `ParticipantID`
* `Name`
* `AssignedGroup`
* `IsActive`

---

### Groups ‚Üí Participants Relationship (FINAL, NON-NEGOTIABLE)

```
Participants.AssignedGroup === Groups.GroupName
```

* `GroupID` is **not** used to fetch participants
* `AssignedGroup` is the **only join key**
* Group names are assumed to be **unique and stable**

‚ùå Do NOT use:

* `Participants.GroupID`
* `Participants.GroupName`
* Derived or inferred joins

---

## üÜï Backend Actions to Implement

### 1. `queryCoordinatorGroups`

**Input**

* Language

**Output**

```json
[
  {
    "groupID": "...",
    "groupName": "...",
    "coordinatorName": "...",
    "status": "Active",
    "weeksCompleted": 6
  }
]
```

**Source**

* Groups sheet

---

### 2. `getGroupMembers`

**Input**

* GroupName

**Output**

```json
[
  {
    "participantID": "...",
    "name": "...",
    "isActive": true
  }
]
```

**Source**

* Participants sheet
* Filter by:

  ```
  AssignedGroup === GroupName
  ```

---

### 3. `updateGroupStatus`

**Input**

```json
{
  "groupID": "...",
  "groupName": "...",
  "status": "Active",
  "weeksCompleted": 8,
  "notes": "...",
  "members": {
    "P001": true,
    "P002": false
  }
}
```

**Backend responsibilities**

* Update Groups sheet (by GroupID):

  * Status
  * WeeksCompleted
  * Notes
* Update Participants sheet (by AssignedGroup):

  * IsActive per participant
* Reject if:

  * GroupID invalid
  * Coordinator mismatch
  * GroupName mismatch
  * Required fields missing

---

## üß† Design Constraints (Non-Negotiable)

* Canonical values only (no translated values stored)
* Backend is the **source of truth**
* Frontend is **UX only**
* Never disable inputs before creating `FormData`
* All updates must be **explicit and idempotent**
* Backend must return **field-specific error messages**

---

## üß™ Testing Expectations

* Coordinator can update **only their group**
* Existing values are always shown before editing
* Status, weeks, notes persist correctly
* Participant activity toggles persist correctly
* reCAPTCHA enforced
* No accidental overwrites

---

## üìå Guiding Principle

> Keep the system **sheet-driven, explicit, auditable, and boring**.
> Avoid clever abstractions. Favor clarity.

---

**Implement backend handlers first, then build the HTML page.**

---
