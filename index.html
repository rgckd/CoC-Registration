<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <title>CoC Participant Registration</title>

  <!-- reCAPTCHA v3 -->
  <script src="https://www.google.com/recaptcha/api.js?render=6Ld11zssAAAAAMa8hkYJHz1AWvXuUh_WIfad0zbT"></script>

  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 720px;
      margin: auto;
      padding: 20px;
    }

    h2 {
      text-align: center;
    }

    label {
      display: block;
      margin-top: 14px;
      font-weight: 600;
    }

    input,
    select {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
    }

    button {
      margin-top: 20px;
      padding: 12px;
      width: 100%;
      font-size: 16px;
      cursor: pointer;
    }

    button:disabled {
      background: #ccc;
      cursor: not-allowed;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }

    th,
    td {
      border: 1px solid #ccc;
      padding: 8px;
      text-align: center;
      vertical-align: middle;
    }

    .hidden {
      display: none;
    }

    #formError {
      color: #d93025;
      font-weight: 600;
      margin-top: 15px;
      display: none;
    }

    .invalid-grid {
      border: 2px solid #d93025;
      padding: 6px;
      border-radius: 4px;
    }

    /* Mobile accordion */
    #timesHeader {
      margin-top: 14px;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      cursor: pointer;
      font-weight: 600;
      display: none;
    }

    #timesSummary {
      display: block;
      font-weight: normal;
      font-size: 14px;
      color: #555;
    }

    @media (max-width:768px) {
      #timesHeader {
        display: block;
      }

      #timesContainer.collapsed {
        display: none;
      }
    }

    .time-icon {
      font-size: 18px;
    }

    .time-label {
      font-size: 13px;
      color: #555;
    }
  </style>
</head>

<body>

  <h2 data-i18n="title">CoC Participant Registration</h2>

  <label>Language / ‡ÆÆ‡Øä‡Æ¥‡Æø / ‡§≠‡§æ‡§∑‡§æ / ‡≤≠‡≤æ‡≤∑‡≥Ü / ‡∞≠‡∞æ‡∞∑</label>
  <select id="langSelect">
  <option value="en">English</option>
  <option value="ta">‡Æ§‡ÆÆ‡Æø‡Æ¥‡Øç</option>
  <option value="hi">‡§π‡§ø‡§®‡•ç‡§¶‡•Ä</option>
  <option value="kn">‡≤ï‡≤®‡≥ç‡≤®‡≤°</option>
  <option value="te">‡∞§‡±Ü‡∞≤‡±Å‡∞ó‡±Å</option>
</select>

  <form id="regForm">

    <input type="hidden" name="Language" id="Language" value="en">
    <input type="text" name="honey" class="hidden">

    <label data-i18n="email_label">Email *</label>
    <input type="email" name="Email" required>

    <label data-i18n="name_label">Your Name *</label>
    <input type="text" name="Name" required>

    <label data-i18n="phone_label">WhatsApp Number *</label>
    <input type="tel" name="WhatsApp" pattern="^[6-9]\d{9}$" required>

    <label data-i18n="center_label">Your Heartfulness Center *</label>
    <input type="text" name="Center" required>

    <div id="englishQuestion">
      <label data-i18n="english_label">Do you know English?</label>
      <select name="English">
      <option value="">Select</option>
      <option value="Yes">Yes</option>
      <option value="No">No</option>
    </select>
    </div>

    <label data-i18n="preferred_times">Preferred days & times *</label>

    <div id="timesHeader" data-i18n="preferred_times">
      Preferred days & times *
      <span id="timesSummary" data-i18n="times_hint">Tap to select</span>
    </div>

    <div id="timesContainer" class="collapsed">
      <table>
        <tr>
          <th data-i18n="day_label">Day</th>
          <th>
            üåÖ <div class="time-label" data-i18n="morning">Morning</div>
          </th>
          <th>
            üåô <div class="time-label" data-i18n="evening">Evening</div>
          </th>
        </tr>

        <tr>
          <td>Mon</td>
          <td><input type="checkbox" name="Times" value="Mon Morning"></td>
          <td><input type="checkbox" name="Times" value="Mon Evening"></td>
        </tr>
        <tr>
          <td>Tue</td>
          <td><input type="checkbox" name="Times" value="Tue Morning"></td>
          <td><input type="checkbox" name="Times" value="Tue Evening"></td>
        </tr>
        <tr>
          <td>Wed</td>
          <td><input type="checkbox" name="Times" value="Wed Morning"></td>
          <td><input type="checkbox" name="Times" value="Wed Evening"></td>
        </tr>
        <tr>
          <td>Thu</td>
          <td><input type="checkbox" name="Times" value="Thu Morning"></td>
          <td><input type="checkbox" name="Times" value="Thu Evening"></td>
        </tr>
        <tr>
          <td>Fri</td>
          <td><input type="checkbox" name="Times" value="Fri Morning"></td>
          <td><input type="checkbox" name="Times" value="Fri Evening"></td>
        </tr>
        <tr>
          <td>Sat</td>
          <td><input type="checkbox" name="Times" value="Sat Morning"></td>
          <td><input type="checkbox" name="Times" value="Sat Evening"></td>
        </tr>
        <tr>
          <td>Sun</td>
          <td><input type="checkbox" name="Times" value="Sun Morning"></td>
          <td><input type="checkbox" name="Times" value="Sun Evening"></td>
        </tr>
      </table>
    </div>

    <label data-i18n="coordinator_label">Willing to be a coordinator? *</label>
    <select name="Coordinator" id="Coordinator" required>
    <option value="">Select</option>
    <option value="Yes">Yes</option>
    <option value="No">No</option>
  </select>

    <p id="formError"></p>
    <button type="submit">Submit Registration</button>
  </form>

  <script>
    document.addEventListener("DOMContentLoaded", () => {

  console.log("JS loaded, DOM ready");

  const WEBAPP_URL = "https://script.google.com/macros/s/AKfycbxPw3PzC2RVFoo1cmxknCiwZeUr_wtECxDrI-2wzfTP3LK0rttnt2EzAuPuJU-M6WniCw/exec";
  const SITE_KEY = "6Ld11zssAAAAAMa8hkYJHz1AWvXuUh_WIfad0zbT";

  const translations = {
    en:{title:"CoC Participant Registration",email_label:"Email *",name_label:"Your Name *",phone_label:"WhatsApp Number *",center_label:"Your Heartfulness Center *",english_label:"Do you know English?",preferred_times:"Preferred days & times *",coordinator_label:"Willing to be a coordinator? *",day_label:"Day",morning:"Morning",evening:"Evening",times_hint:"Tap to select"},
    ta:{title:"CoC ‡Æ™‡Æô‡Øç‡Æï‡Øá‡Æ±‡Øç‡Æ™‡Ææ‡Æ≥‡Æ∞‡Øç ‡Æ™‡Æ§‡Æø‡Æµ‡ØÅ",email_label:"‡ÆÆ‡Æø‡Æ©‡Øç‡Æ©‡Æû‡Øç‡Æö‡Æ≤‡Øç *",name_label:"‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡Øç ‡Æ™‡ØÜ‡ÆØ‡Æ∞‡Øç *",phone_label:"‡Æµ‡Ææ‡Æü‡Øç‡Æ∏‡Ææ‡Æ™‡Øç‡Æ™‡Øç ‡Æé‡Æ£‡Øç *",center_label:"‡Æπ‡Ææ‡Æ∞‡Øç‡Æü‡Øç‡ÆÉ‡Æ™‡ØÅ‡Æ≤‡Øç‡Æ©‡ØÜ‡Æ∏‡Øç ‡Æö‡ØÜ‡Æ©‡Øç‡Æü‡Æ∞‡Øç *",english_label:"‡Æâ‡Æô‡Øç‡Æï‡Æ≥‡ØÅ‡Æï‡Øç‡Æï‡ØÅ ‡ÆÜ‡Æô‡Øç‡Æï‡Æø‡Æ≤‡ÆÆ‡Øç ‡Æ§‡ØÜ‡Æ∞‡Æø‡ÆØ‡ØÅ‡ÆÆ‡Ææ?",preferred_times:"‡Æµ‡Æø‡Æ∞‡ØÅ‡Æ™‡Øç‡Æ™‡ÆÆ‡Ææ‡Æ© ‡Æ®‡Ææ‡Æü‡Øç‡Æï‡Æ≥‡Øç & ‡Æ®‡Øá‡Æ∞‡Æô‡Øç‡Æï‡Æ≥‡Øç *",coordinator_label:"‡Æí‡Æ∞‡ØÅ‡Æô‡Øç‡Æï‡Æø‡Æ£‡Øà‡Æ™‡Øç‡Æ™‡Ææ‡Æ≥‡Æ∞‡Ææ‡Æï ‡Æá‡Æ∞‡ØÅ‡Æï‡Øç‡Æï ‡Æ§‡ÆØ‡Ææ‡Æ∞‡Ææ? *",day_label:"‡Æ®‡Ææ‡Æ≥‡Øç",morning:"‡Æï‡Ææ‡Æ≤‡Øà",evening:"‡ÆÆ‡Ææ‡Æ≤‡Øà",times_hint:"‡Æ§‡Øá‡Æ∞‡Øç‡Æµ‡ØÅ ‡Æö‡ØÜ‡ÆØ‡Øç‡ÆØ ‡Æ§‡Æü‡Øç‡Æü‡Æµ‡ØÅ‡ÆÆ‡Øç"},
    hi:{title:"CoC ‡§™‡•ç‡§∞‡§§‡§ø‡§≠‡§æ‡§ó‡•Ä ‡§™‡§Ç‡§ú‡•Ä‡§ï‡§∞‡§£",email_label:"‡§à‡§Æ‡•á‡§≤ *",name_label:"‡§Ü‡§™‡§ï‡§æ ‡§®‡§æ‡§Æ *",phone_label:"‡§µ‡•ç‡§π‡§æ‡§ü‡•ç‡§∏‡§è‡§™ ‡§®‡§Ç‡§¨‡§∞ *",center_label:"‡§π‡§æ‡§∞‡•ç‡§ü‡§´‡•Å‡§≤‡§®‡•á‡§∏ ‡§ï‡•á‡§Ç‡§¶‡•ç‡§∞ *",english_label:"‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™‡§ï‡•ã ‡§Ö‡§Ç‡§ó‡•ç‡§∞‡•á‡§ú‡§º‡•Ä ‡§Ü‡§§‡•Ä ‡§π‡•à?",preferred_times:"‡§™‡§∏‡§Ç‡§¶‡•Ä‡§¶‡§æ ‡§¶‡§ø‡§® ‡§î‡§∞ ‡§∏‡§Æ‡§Ø *",coordinator_label:"‡§ï‡•ç‡§Ø‡§æ ‡§Ü‡§™ ‡§∏‡§Æ‡§®‡•ç‡§µ‡§Ø‡§ï ‡§¨‡§®‡§®‡§æ ‡§ö‡§æ‡§π‡•á‡§Ç‡§ó‡•á? *",day_label:"‡§¶‡§ø‡§®",morning:"‡§∏‡•Å‡§¨‡§π",evening:"‡§∂‡§æ‡§Æ",times_hint:"‡§ö‡•Å‡§®‡§®‡•á ‡§ï‡•á ‡§≤‡§ø‡§è ‡§ü‡•à‡§™ ‡§ï‡§∞‡•á‡§Ç"},
    kn:{title:"CoC ‡≤®‡≥ã‡≤Ç‡≤¶‡≤£‡≤ø",email_label:"‡≤á‡≤Æ‡≥á‡≤≤‡≥ç *",name_label:"‡≤®‡≤ø‡≤Æ‡≥ç‡≤Æ ‡≤π‡≥Ü‡≤∏‡≤∞‡≥Å *",phone_label:"‡≤µ‡≤æ‡≤ü‡≥ç‡≤∏‡≤æ‡≤™‡≥ç ‡≤∏‡≤Ç‡≤ñ‡≥ç‡≤Ø‡≥Ü *",center_label:"‡≤π‡≤æ‡≤∞‡≥ç‡≤ü‡≥ç‚Äå‡≤´‡≥Å‡≤≤‡≥ç‚Äå‡≤®‡≥Ü‡≤∏‡≥ç ‡≤ï‡≥á‡≤Ç‡≤¶‡≥ç‡≤∞ *",english_label:"‡≤®‡≥Ä‡≤µ‡≥Å ‡≤á‡≤Ç‡≤ó‡≥ç‡≤≤‡≤ø‡≤∑‡≥ç ‡≤§‡≤ø‡≤≥‡≤ø‡≤¶‡≤ø‡≤¶‡≥ç‡≤¶‡≥Ä‡≤∞‡≤æ?",preferred_times:"‡≤Ü‡≤¶‡≥ç‡≤Ø‡≤§‡≥Ü‡≤Ø ‡≤¶‡≤ø‡≤®‡≤ó‡≤≥‡≥Å ‡≤Æ‡≤§‡≥ç‡≤§‡≥Å ‡≤∏‡≤Æ‡≤Ø‡≤ó‡≤≥‡≥Å *",coordinator_label:"‡≤®‡≥Ä‡≤µ‡≥Å ‡≤∏‡≤Ç‡≤Ø‡≥ã‡≤ú‡≤ï‡≤∞‡≤æ‡≤ó‡≤≤‡≥Å ‡≤á‡≤ö‡≥ç‡≤õ‡≤ø‡≤∏‡≥Å‡≤§‡≥ç‡≤§‡≥Ä‡≤∞‡≤æ? *",day_label:"‡≤¶‡≤ø‡≤®",morning:"‡≤¨‡≥Ü‡≤≥‡≤ó‡≥ç‡≤ó‡≥Ü",evening:"‡≤∏‡≤Ç‡≤ú‡≥Ü",times_hint:"‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü ‡≤Æ‡≤æ‡≤°‡≤≤‡≥Å ‡≤ü‡≥ç‡≤Ø‡≤æ‡≤™‡≥ç ‡≤Æ‡≤æ‡≤°‡≤ø"},
    te:{title:"CoC ‡∞®‡∞Æ‡±ã‡∞¶‡±Å",email_label:"‡∞á‡∞Æ‡±Ü‡∞Ø‡∞ø‡∞≤‡±ç *",name_label:"‡∞Æ‡±Ä ‡∞™‡±á‡∞∞‡±Å *",phone_label:"‡∞µ‡∞æ‡∞ü‡±ç‡∞∏‡∞æ‡∞™‡±ç ‡∞®‡∞Ç‡∞¨‡∞∞‡±ç *",center_label:"‡∞π‡∞æ‡∞∞‡±ç‡∞ü‡±ç‚Äå‡∞´‡±Å‡∞≤‡±ç‚Äå‡∞®‡±Ü‡∞∏‡±ç ‡∞ï‡±á‡∞Ç‡∞¶‡±ç‡∞∞‡∞Ç *",english_label:"‡∞Æ‡±Ä‡∞ï‡±Å ‡∞Ü‡∞Ç‡∞ó‡±ç‡∞≤‡∞Ç ‡∞§‡±Ü‡∞≤‡±Å‡∞∏‡∞æ?",preferred_times:"‡∞á‡∞∑‡±ç‡∞ü‡∞Æ‡±à‡∞® ‡∞∞‡±ã‡∞ú‡±Å‡∞≤‡±Å & ‡∞∏‡∞Æ‡∞Ø‡∞æ‡∞≤‡±Å *",coordinator_label:"‡∞∏‡∞Æ‡∞®‡±ç‡∞µ‡∞Ø‡∞ï‡∞∞‡±ç‡∞§‡∞ó‡∞æ ‡∞â‡∞Ç‡∞°‡∞æ‡∞≤‡∞æ? *",day_label:"‡∞∞‡±ã‡∞ú‡±Å",morning:"‡∞â‡∞¶‡∞Ø‡∞Ç",evening:"‡∞∏‡∞æ‡∞Ø‡∞Ç‡∞§‡±ç‡∞∞‡∞Ç",times_hint:"‡∞é‡∞Ç‡∞ö‡±Å‡∞ï‡±ã‡∞µ‡∞°‡∞æ‡∞®‡∞ø‡∞ï‡∞ø ‡∞ü‡±ç‡∞Ø‡∞æ‡∞™‡±ç ‡∞ö‡±á‡∞Ø‡∞Ç‡∞°‡∞ø"}
  };

  function applyLanguage(lang){
    const dict = translations[lang];
    document.querySelectorAll("[data-i18n]").forEach(el=>{
      if(dict[el.dataset.i18n]){
        el.textContent = dict[el.dataset.i18n];
      }
    });
  }

  const langSelect = document.getElementById("langSelect");
  langSelect.addEventListener("change", e => {
    const lang = e.target.value;
    document.getElementById("Language").value = lang;
    applyLanguage(lang);
  });

  applyLanguage("en");

  const form = document.getElementById("regForm");
  const errorEl = document.getElementById("formError");

  form.addEventListener("submit", e => {
    e.preventDefault();
    console.log("Submit intercepted");

    errorEl.style.display = "none";

    grecaptcha.ready(() => {
      grecaptcha.execute(SITE_KEY, { action: "submit" }).then(token => {

        const fd = new FormData(form);
        fd.append("recaptcha", token);

        fetch(WEBAPP_URL, {
          method: "POST",
          body: fd
        })
        .then(r => r.json())
        .then(res => {
          if (res.result === "success") {
            const lang = document.getElementById("Language").value || "en";
            window.location.href = "success.html?lang=" + lang;
          } else {
            errorEl.textContent = res.error || "Submission failed.";
            errorEl.style.display = "block";
          }
        })
        .catch(err => {
          console.error(err);
          errorEl.textContent = "Network error. Please try again.";
          errorEl.style.display = "block";
        });

      });
    });
  });

});
</script>


</body>

</html>